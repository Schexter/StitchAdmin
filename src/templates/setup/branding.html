{% extends "setup/base_setup.html" %}
{% block title %}Logo & Branding{% endblock %}

{% block content %}
<div class="step-indicator">
    <div class="step-number">üé®</div>
    <h3 class="mt-3">Logo & Branding</h3>
    <p class="text-muted">Passen Sie das Erscheinungsbild an</p>
</div>

<form method="POST" enctype="multipart/form-data">
    <div class="row">
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-image me-2"></i>Firmenlogo</h5>
                </div>
                <div class="card-body text-center">
                    <div class="mb-3" style="min-height: 120px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ddd; border-radius: 10px; padding: 20px;">
                        {% if company and company.logo_path %}
                        <img src="{{ url_for('static', filename=company.logo_path) }}" alt="Logo" style="max-height: 100px; max-width: 100%;" id="logoPreview">
                        {% else %}
                        <div id="logoPlaceholder" class="text-muted">
                            <i class="fas fa-image fa-3x mb-2"></i><br>
                            Kein Logo hochgeladen
                        </div>
                        <img src="" id="logoPreview" style="max-height: 100px; max-width: 100%; display: none;">
                        {% endif %}
                    </div>
                    <input type="file" name="logo" id="logoInput" class="form-control" accept=".png,.jpg,.jpeg,.gif,.svg">
                    <small class="text-muted">PNG, JPG, SVG - max. 2MB</small>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-palette me-2"></i>Farben</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Prim√§rfarbe</label>
                        <div class="input-group">
                            <input type="color" class="form-control form-control-color" 
                                   name="primary_color" id="primaryColor"
                                   value="{{ branding.primary_color if branding else '#0d6efd' }}"
                                   style="height: 45px;">
                            <input type="text" class="form-control" id="primaryColorText" 
                                   value="{{ branding.primary_color if branding else '#0d6efd' }}"
                                   readonly>
                        </div>
                        <small class="text-muted">Hauptfarbe f√ºr Buttons und Links</small>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Sekund√§rfarbe</label>
                        <div class="input-group">
                            <input type="color" class="form-control form-control-color" 
                                   name="secondary_color" id="secondaryColor"
                                   value="{{ branding.secondary_color if branding else '#6c757d' }}"
                                   style="height: 45px;">
                            <input type="text" class="form-control" id="secondaryColorText" 
                                   value="{{ branding.secondary_color if branding else '#6c757d' }}"
                                   readonly>
                        </div>
                        <small class="text-muted">Akzentfarbe</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="alert alert-light">
        <i class="fas fa-info-circle me-2"></i>
        Das Logo wird auf Rechnungen, Angeboten und anderen Dokumenten angezeigt. 
        Empfohlen: Transparentes PNG mit mind. 300x100 Pixel.
    </div>
    
    <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('setup.company') }}" class="btn btn-outline-secondary btn-setup">
            <i class="fas fa-arrow-left me-2"></i> Zur√ºck
        </a>
        <button type="submit" class="btn btn-primary btn-setup">
            Weiter <i class="fas fa-arrow-right ms-2"></i>
        </button>
    </div>
</form>
{% endblock %}

{% block extra_js %}
<script>
// Logo-Vorschau
document.getElementById('logoInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('logoPreview').src = e.target.result;
            document.getElementById('logoPreview').style.display = 'block';
            const placeholder = document.getElementById('logoPlaceholder');
            if (placeholder) placeholder.style.display = 'none';
        };
        reader.readAsDataURL(file);
    }
});

// Farb-Sync
document.getElementById('primaryColor').addEventListener('input', function() {
    document.getElementById('primaryColorText').value = this.value;
});
document.getElementById('secondaryColor').addEventListener('input', function() {
    document.getElementById('secondaryColorText').value = this.value;
});
</script>
{% endblock %}
